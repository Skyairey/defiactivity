services:
  # Frontend - Static Site
  - type: web
    name: defi-hub-frontend
    env: static
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist
    routes:
      - type: rewrite
        source: /api/*
        destination: https://defi-hub-api.onrender.com/api/*
    envVars:
      - key: NODE_VERSION
        value: 18

  # Backend Cron Job - Updates leaderboard every 2 days
  - type: cron
    name: defi-hub-updater
    env: node
    schedule: "0 3 */2 * *"  # Every 2 days at 3:00 AM UTC
    buildCommand: cd backend && npm install
    startCommand: node backend/twitter_indexer.js
    envVars:
      - key: NODE_VERSION
        value: 18
      - key: API_KEY
        sync: false  # Set in Render dashboard
      - key: COMMUNITY_ID
        sync: false  # Set in Render dashboard
